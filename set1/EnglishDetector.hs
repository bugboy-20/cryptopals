module EnglishDetector
   where

import Data.Map.Strict
import Data.Maybe (fromMaybe)

import Data.Char

--http://web.archive.org/web/20170827132854/http://scottbryce.com/cryptograms/stats.htm

sumVoto (m:n:l)
  | m == n && (m `elem` "setflmo") = 4* voto' m + sumVoto l
  | m == ' ' && (n `elem` "toawbcdsfmrhiyeglnoujk") = 2*(voto' m + voto' n) + sumVoto l
  | otherwise = voto' m + sumVoto (n:l)
sumVoto (n:l) = voto' n + sumVoto l
sumVoto [] = 0


--media?
voto = sumVoto . Prelude.map toUpper -- / fromIntegral (length s)

voto' c = fromMaybe 0 $ freqMap !? c


freqMap =fromList l


--l :: [(Char,Double)]

l =
   [
    ('e',57),
    ('a',43),
    ('r',39),
    ('i',38),
    ('o',37),
    (' ',37),
    ('t',35),
    ('n',34),
    ('s',29),
    ('l',28),
    ('c',23),
    ('u',19),
    ('d',17),
    ('p',16),
    ('m',15),
    ('h',15),
    ('g',13),
    ('b',11),
    ('f',9),
    ('y',9),
    ('w',7),
    ('k',6),
    ('v',5),
    ('x',1),
    ('z',1),
    ('j',1),
    ('q',1)
   ]


--l = [(' ',0.167564443682168),('e',8.610229517681191e-2),('t',6.32964962389326e-2),('a',6.12553996079051e-2),('n',5.503703643138501e-2),('i',5.480626188138746e-2),('o',5.41904405334676e-2),('s',5.18864979648296e-2),('r',5.1525029341199825e-2),('l',3.218192615049607e-2),('d',3.188948073064199e-2),('h',2.619237267611581e-2),('c',2.500268898936656e-2),('\n',1.9578060965172565e-2),('u',1.9247776378510318e-2),('m',1.8140172626462205e-2),('p',1.7362092874808832e-2),('f',1.5750347191785568e-2),('g',1.2804659959943725e-2),('.',1.1055184780313847e-2),('y',1.0893686962847832e-2),('b',1.034644514338097e-2),('w',9.565830104169261e-3),(',',8.634492219614468e-3),('v',7.819143740853554e-3),('0',5.918945715880591e-3),('k',4.945712204424292e-3),('1',4.937789430804492e-3),('S',3.0896915651553373e-3),('T',3.0701064687671904e-3),('C',2.987392712176473e-3),('2',2.756237869045172e-3),('8',2.552781042488694e-3),('5',2.5269211093936652e-3),('A',2.4774830020061096e-3),('9',2.442242504945237e-3),('x',2.3064144740073764e-3),('3',2.1865587546870337e-3),('I',2.0910417959267183e-3),('-',2.076717421222119e-3),('6',1.9199098857390264e-3),('4',1.8385271551164353e-3),('7',1.8243295447897528e-3),('M',1.8134911904778657e-3),('B',1.7387002075069484e-3),('"',1.5754276887500987e-3),('\'',1.5078622753204398e-3),('P',1.38908405321239e-3),('E',1.2938206232079082e-3),('N',1.2758834637326799e-3),('F',1.220297284016159e-3),('R',1.1037374385216535e-3),('D',1.0927723198318497e-3),('U',1.0426370083657518e-3),('q',1.00853739070613e-3),('L',1.0044809306127922e-3),('G',9.310209736100016e-4),('J',8.814561018445294e-4),('H',8.752446473266058e-4),('O',8.210528757671701e-4),('W',8.048270353938186e-4),('j',6.17596049210692e-4),('z',5.762708620098124e-4),('/',5.19607185080999e-4),('<',4.4107665296153596e-4),('>',4.404428310719519e-4),('K',3.808001912620934e-4),(')',3.314254660634964e-4),('(',3.307916441739124e-4),('V',2.556203680692448e-4),('Y',2.5194420110965734e-4),(':',1.2036277683200988e-4),('Q',1.0001709417636208e-4),('Z',8.619977698342993e-5),('X',6.572732994986532e-5),(';',7.41571610813331e-6),('?',4.626899793963519e-6),('^',2.2183766135441526e-6),('&',2.0282300466689395e-6),('+',1.5211725350017046e-6),('[',6.97204078542448e-7),(']',6.338218895840436e-7),('$',5.070575116672349e-7),('!',5.070575116672349e-7),('*',4.436753227088305e-7),('=',2.5352875583361743e-7),('~',1.9014656687521307e-7),('_',1.2676437791680872e-7),('\t',1.2676437791680872e-7),('{',6.338218895840436e-8),('@',6.338218895840436e-8)]
